// Test file for user-defined class autocompletion and type checking

// Define a simple class
class Point:
    let x
    let y
    
    Point(x, y):
        this.x = x
        this.y = y
    end
    
    def distance() -> Float:
        return (this.x * this.x + this.y * this.y)
    end
    
    def toString() -> String:
        return "Point(#{this.x}, #{this.y})"
    end
end

// Define another class hierarchy
class Animal:
    name: String
    
    Animal(name: String):
        this.name = name
    end
    
    def speak() -> String:
        return "Some sound"
    end
end

class Dog < Animal:
    Dog(name: String):
        super(name)
    end
    
    def speak() -> String:
        return "Woof!"
    end
end

class Cat < Animal:
    Cat(name: String):
        super(name)
    end
    
    def speak() -> String:
        return "Meow!"
    end
end

// ========================================
// FEATURE 1: Automatic type inference
// ========================================
// When you type "var p = Point(5, 10)", the extension automatically infers
// that p is of type Point, without needing explicit ": Point" annotation

var p = Point(5, 10)
// Now when you type "p." you should see autocompletion for:
// - distance()
// - toString()
// - x (field)
// - y (field)
println(p.distance())
println(p.toString())

// ========================================
// FEATURE 2: Explicit type with correct assignment
// ========================================
var dog: Dog = Dog("Buddy")
println(dog.speak())  // Autocomplete shows: speak(), name

// ========================================
// FEATURE 3: Inheritance compatibility checking
// ========================================
// Dog extends Animal, so this assignment is VALID
var animal: Animal = Dog("Max")
println(animal.speak())  // Autocomplete shows: speak(), name

// ========================================
// FEATURE 4: Type mismatch detection (ERRORS)
// ========================================
// EXPECTED ERROR: Cat is not compatible with Dog
// This should show an error because Cat and Dog are sibling classes
var wrongType: Dog = Cat("Whiskers")

// EXPECTED ERROR: Dog is not compatible with Cat
// This should also show an error
var incompatible: Cat = Dog("Rex")

// ========================================
// FEATURE 5: Automatic inference with inherited methods
// ========================================
var myAnimal = Cat("Fluffy")
// When you type "myAnimal." you should see autocompletion for:
// - speak() (overridden method)
// - name (inherited field from Animal)
println(myAnimal.speak())
println(myAnimal.name)
